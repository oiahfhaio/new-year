<!DOCTYPE html>
<html lang="zh-CN">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0, user-scalable=no, maximum-scale=1.0">
    <title>2026 æ–°å¹´å¿«ä¹</title>
    <style>
        @import url('https://fonts.googleapis.com/css2?family=Cinzel:wght@800&family=Noto+Serif+SC:wght@300;900&display=swap');

        body, html {
            margin: 0; padding: 0; width: 100%; height: 100%;
            overflow: hidden; background-color: #050505;
            font-family: 'Noto Serif SC', serif;
            -webkit-tap-highlight-color: transparent; /* å»é™¤ç‚¹å‡»é«˜äº® */
        }

        /* --- 1. æš´åŠ›ä¿®å¤ç‰ˆå¼€å±é®ç½© --- */
        #start-overlay {
            position: fixed; top: 0; left: 0; width: 100%; height: 100%;
            background: rgba(0, 0, 0, 0.95);
            z-index: 2147483647; /* ç¡®ä¿å±‚çº§æœ€é«˜ */
            display: flex; justify-content: center; align-items: center;
            /* è§¦æ‘¸ç©¿é€å¤„ç† */
            touch-action: manipulation; 
        }

        .start-btn {
            font-size: 1.8rem; font-weight: 900; color: #FFD700;
            border: 4px solid #FFD700; padding: 30px 60px;
            border-radius: 80px; background: rgba(255, 215, 0, 0.1);
            box-shadow: 0 0 50px rgba(255, 215, 0, 0.5);
            animation: pulse 1.5s infinite;
            pointer-events: none; /* è®©ç‚¹å‡»ç©¿é€ç»™çˆ¶çº§divï¼Œä¿è¯çµæ• */
        }
        @keyframes pulse {
            0% { transform: scale(1); }
            50% { transform: scale(1.05); box-shadow: 0 0 80px rgba(255,215,0,0.8); }
            100% { transform: scale(1); }
        }

        /* --- 2. é¡µé¢å…ƒç´  --- */
        canvas { position: absolute; top: 0; left: 0; z-index: 1; }

        .music-btn {
            position: fixed; top: 20px; right: 20px; z-index: 100;
            width: 40px; height: 40px;
            background: rgba(255, 255, 255, 0.2);
            border: 2px solid #FFD700; border-radius: 50%;
            display: flex; justify-content: center; align-items: center;
            animation: rotate 4s linear infinite; opacity: 0; transition: opacity 1s;
        }
        .music-btn.paused { animation-play-state: paused; opacity: 0.5; }
        @keyframes rotate { to { transform: rotate(360deg); } }

        /* ä¸­é—´æ–‡å­—å±‚ */
        .center-text {
            position: absolute; top: 45%; left: 50%;
            transform: translate(-50%, -50%);
            z-index: 10; text-align: center; width: 100%;
            pointer-events: none;
        }

        .year {
            font-family: 'Cinzel', serif; font-size: 7rem;
            font-weight: 900; line-height: 1; margin-bottom: 10px;
            background: linear-gradient(to bottom, #fff, #FFD700);
            -webkit-background-clip: text; -webkit-text-fill-color: transparent;
            text-shadow: 0 0 50px rgba(255, 215, 0, 0.6);
            animation: breath 3s ease-in-out infinite alternate;
        }
        @keyframes breath { 0% { transform: scale(1); } 100% { transform: scale(1.1); } }

        /* æ ¸å¿ƒä¿®æ”¹ï¼šä¸­å¤®ç¥ç¦è¯­ (å¢åŠ è¿‡æ¸¡æ•ˆæœ) */
        #main-blessing {
            font-size: 1.3rem; 
            color: #ffecd2; 
            letter-spacing: 6px; 
            margin-bottom: 15px;
            opacity: 1;
            transition: opacity 1s ease-in-out; /* æ·¡å…¥æ·¡å‡ºå…³é”®ä»£ç  */
            text-shadow: 0 0 10px rgba(255, 215, 0, 0.3);
            font-weight: bold;
        }

        .name-box {
            font-size: 2.5rem; color: white; font-weight: 700;
            text-shadow: 0 0 20px white;
            border-bottom: 3px solid #FFD700;
            display: inline-block; padding-bottom: 10px;
        }

        /* åº•éƒ¨æç¤º */
        #inner-tip-box {
            margin-top: 50px; display: inline-block;
            color: #FFD700; border: 1px solid #FFD700;
            padding: 10px 30px; border-radius: 30px;
            font-size: 1.2rem; font-weight: bold;
            background: rgba(0,0,0,0.5);
            opacity: 0; animation: flash 1s infinite alternate;
        }
        @keyframes flash { from { opacity: 0.5; } to { opacity: 1; transform: scale(1.05); } }

        /* å¼¹å¹• */
        #danmaku-container {
            position: absolute; top: 0; left: 0; width: 100%; height: 100%;
            z-index: 5; pointer-events: none; overflow: hidden;
        }
        .danmaku-item {
            position: absolute; white-space: nowrap; color: white;
            font-size: 1.2rem; font-weight: bold;
            text-shadow: 0 0 5px black;
            animation: move 10s linear forwards;
        }
        @keyframes move { from { transform: translateX(100vw); } to { transform: translateX(-100%); } }

        @media screen and (max-width: 480px) {
            .year { font-size: 5.5rem; }
            .start-btn { padding: 20px 40px; font-size: 1.5rem; }
            #main-blessing { font-size: 1.1rem; letter-spacing: 4px; }
        }
    </style>
</head>
<body>

    <audio id="bgm" loop preload="auto">
        <source src="Vexento - Lonely Dance.mp3" type="audio/mpeg">
    </audio>

    <!-- å¼€å±é®ç½©ï¼šonclick æš´åŠ›ç»‘å®šï¼Œç¡®ä¿å¿…åº” -->
    <div id="start-overlay" onclick="startApp()">
        <div class="start-btn">
            ğŸ‘‡ ç‚¹å‡»å±å¹•<br>å¼€å¯ 2026
        </div>
    </div>

    <div class="music-btn" id="musicBtn"><div style="font-size: 20px;">ğŸµ</div></div>

    <canvas id="canvas"></canvas>
    <div id="danmaku-container"></div>

    <div class="center-text">
        <div class="year">2026</div>
        
        <!-- è¿™é‡Œæ˜¯è‡ªåŠ¨åˆ‡æ¢çš„ç¥ç¦è¯­ -->
        <div id="main-blessing">æ–°å²åºå¼€ Â· å…±èµ´å±±æµ·</div>
        
        <div class="name-box" id="name-display">To: æœ‹å‹</div>
        <br>
        <div id="inner-tip-box">ğŸ‘† ç‚¹ç‚¹å±å¹• Â· è§¦å‘æƒŠå–œ ğŸ‘†</div>
    </div>

    <script>
        // --- 1. å¯åŠ¨é€»è¾‘ (æœ€ç¨³ç‰ˆ) ---
        const overlay = document.getElementById('start-overlay');
        const bgm = document.getElementById('bgm');
        const musicBtn = document.getElementById('musicBtn');
        const innerTip = document.getElementById('inner-tip-box');
        let started = false;

        function startApp() {
            if (started) return;
            started = true;
            // ç•Œé¢ç«‹åˆ»åé¦ˆ
            overlay.style.display = 'none';
            musicBtn.style.opacity = '1';
            innerTip.style.opacity = '1';
            // æ’­æ”¾éŸ³ä¹
            bgm.play().catch(e => { musicBtn.classList.add('paused'); });
            // å¼€åœºçƒŸèŠ±
            for(let i=0; i<3; i++) setTimeout(() => createFirework(window.innerWidth/2, window.innerHeight*0.3), i*300);
            
            // å¯åŠ¨ä¸­å¤®ç¥ç¦è¯­è½®æ’­
            setInterval(rotateMainBlessing, 4000); 
        }
        
        // å…¼å®¹è§¦æ‘¸
        overlay.addEventListener('touchstart', (e) => { e.preventDefault(); startApp(); }, {passive: false});


        // --- 2. ä¸­å¤®ç¥ç¦è¯­è½®æ’­é€»è¾‘ (æ–°å¢) ---
        const mainBlessingElement = document.getElementById('main-blessing');
        // è¿™é‡Œæ˜¯ä¸€äº›æ¯”è¾ƒé«˜çº§ã€ç®€çŸ­çš„æˆè¯­æˆ–è¯—å¥
        const mainMessages = [
            "æ–°å²åºå¼€ Â· å…±èµ´å±±æµ·",
            "å²å²å¸¸æ¬¢æ„‰ Â· å¹´å¹´çš†èƒœæ„",
            "çƒŸç«å‘æ˜Ÿè¾° Â· æ‰€æ„¿çš†æˆçœŸ",
            "ä¸‡ç‰©æ›´æ–° Â· æ—§ç–¾å½“æ„ˆ",
            "ä¿æŒçƒ­çˆ± Â· å¥”èµ´å±±æµ·",
            "å‰è·¯æµ©æµ©è¡è¡ Â· ä¸‡äº‹å°½å¯æœŸå¾…",
            "å¤šå–œä¹ Â· é•¿å®‰å®"
        ];
        let mainMsgIndex = 0;

        function rotateMainBlessing() {
            // 1. å…ˆæ·¡å‡º (opacityå˜0)
            mainBlessingElement.style.opacity = 0;
            
            // 2. ç­‰1ç§’æ·¡å‡ºåŠ¨ç”»å®Œæˆåï¼Œæ¢å­—ï¼Œå†æ·¡å…¥
            setTimeout(() => {
                mainMsgIndex = (mainMsgIndex + 1) % mainMessages.length;
                mainBlessingElement.innerText = mainMessages[mainMsgIndex];
                mainBlessingElement.style.opacity = 1; // æ·¡å…¥
            }, 1000); 
        }


        // --- 3. åå­— & å¼¹å¹• ---
        const params = new URLSearchParams(window.location.search);
        let nameText = params.get('name') || "æœ‹å‹";
        document.getElementById('name-display').innerText = "To: " + nameText;

        const container = document.getElementById('danmaku-container');
        // è¿™é‡Œçš„ç¥ç¦è¯­æ˜¯é£˜è¿‡çš„ï¼Œæ¯”è¾ƒå£è¯­åŒ–
        const msgs = [
            "ç¥ {n} 2026 è´¢æºå¹¿è¿›", "æ„¿ {n} å¤©å¤©å¼€å¿ƒ", "{n} æ–°å¹´å¿«ä¹ ä¸‡äº‹èƒœæ„",
            "ç¥ {n} é¢œå€¼çˆ†è¡¨", "æ„¿ {n} å²å²å¹³å®‰", "{n} 2026 æš´å¯Œæš´ç˜¦",
            "ç¥ {n} å¥½è¿è¿è¿", "æ„¿ {n} å¿ƒæƒ³äº‹æˆ", "{n} å¿…å®š å‡èŒåŠ è–ª",
            "ç¥ {n} æ°¸è¿œå°‘å¹´", "æ„¿ {n} æ‰€æ±‚çš†å¦‚æ„¿", "ç¥ {n} å‰ç¨‹ä¼¼é”¦"
        ];

        function sendDanmaku(text=null, y=null) {
            const div = document.createElement('div');
            div.className = 'danmaku-item';
            div.innerText = (text || msgs[Math.floor(Math.random()*msgs.length)]).replace(/{n}/g, nameText);
            if(y) { 
                div.style.top = (y - 50) + 'px';
                div.style.color = '#FFD700'; div.style.textShadow = '0 0 20px #FFD700';
                div.style.fontSize = '1.5rem'; div.style.zIndex = 100;
            } else {
                div.style.top = Math.random()*70 + 5 + '%';
            }
            container.appendChild(div);
            setTimeout(() => div.remove(), 8000);
        }
        setInterval(() => sendDanmaku(), 800);

        // --- 4. çƒŸèŠ±å¼•æ“ ---
        const canvas = document.getElementById('canvas');
        const ctx = canvas.getContext('2d');
        let w, h; resize();
        window.addEventListener('resize', resize);
        function resize() { w=canvas.width=window.innerWidth; h=canvas.height=window.innerHeight; }
        
        let particles = [];
        const r = (min, max) => Math.random() * (max - min) + min;

        class P {
            constructor(x, y, color) {
                this.x=x; this.y=y; this.color=color;
                const angle = Math.random() * Math.PI * 2;
                const speed = r(4, 10);
                this.vx = Math.cos(angle)*speed; this.vy = Math.sin(angle)*speed;
                this.alpha = 1; this.decay = r(0.01, 0.03);
            }
            update() { this.x+=this.vx; this.y+=this.vy; this.vy+=0.05; this.vx*=0.96; this.vy*=0.96; this.alpha-=this.decay; }
            draw() {
                ctx.globalAlpha = this.alpha; ctx.fillStyle = this.color;
                ctx.beginPath(); ctx.arc(this.x, this.y, 2, 0, Math.PI*2); ctx.fill();
            }
        }

        function createFirework(x, y) {
            const isHeart = Math.random() < 0.3;
            const count = 100;
            const hue = isHeart ? 340 : Math.random()*360;
            for(let i=0; i<count; i++) {
                if(isHeart) {
                     const a = (Math.PI*2*i)/count;
                     const px = 16 * Math.pow(Math.sin(a), 3);
                     const py = -(13*Math.cos(a) - 5*Math.cos(2*a) - 2*Math.cos(3*a) - Math.cos(4*a));
                     const p = new P(x, y, `hsl(${hue}, 90%, 60%)`);
                     p.vx = px*0.2; p.vy = py*0.2;
                     particles.push(p);
                } else {
                     particles.push(new P(x, y, `hsl(${hue}, 90%, 60%)`));
                }
            }
        }

        function loop() {
            ctx.globalCompositeOperation = 'source-over';
            ctx.fillStyle = 'rgba(0,0,0,0.2)'; ctx.fillRect(0,0,w,h);
            ctx.globalCompositeOperation = 'lighter';
            for(let i=particles.length-1; i>=0; i--) {
                particles[i].update(); particles[i].draw();
                if(particles[i].alpha<=0) particles.splice(i,1);
            }
            if(Math.random()<0.04) createFirework(Math.random()*w, h*0.3);
            requestAnimationFrame(loop);
        }
        loop();

        window.addEventListener('pointerdown', (e) => {
            if(!started) return;
            createFirework(e.clientX, e.clientY);
            const msg = msgs[Math.floor(Math.random()*msgs.length)].replace(/{n}/g, nameText);
            sendDanmaku(msg, e.clientY);
        });

        musicBtn.addEventListener('click', (e) => {
            e.stopPropagation();
            if(bgm.paused) { bgm.play(); musicBtn.classList.remove('paused'); }
            else { bgm.pause(); musicBtn.classList.add('paused'); }
        });
    </script>
</body>
</html>

