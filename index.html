<!DOCTYPE html>
<html lang="zh-CN">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0, user-scalable=no, maximum-scale=1.0">
    <title>2026 æ–°å¹´å¿«ä¹</title>
    <style>
        /* --- 0. å­—ä½“å¼•å…¥ (ä½¿ç”¨ç³»ç»Ÿå­—ä½“ï¼Œé˜²ç™½å±ï¼Œç¨³ï¼) --- */
        @import url('https://fonts.googleapis.com/css2?family=Cinzel:wght@800&family=Noto+Serif+SC:wght@300;700;900&display=swap');

        /* --- 1. å…¨å±€è®¾ç½® --- */
        body, html {
            margin: 0; padding: 0; width: 100%; height: 100%;
            overflow: hidden; background-color: #050505;
            font-family: 'Noto Serif SC', serif;
            -webkit-tap-highlight-color: transparent;
        }

        /* --- 2. å¼€å±é®ç½© --- */
        #start-overlay {
            position: fixed; top: 0; left: 0; width: 100%; height: 100%;
            background: rgba(0, 0, 0, 0.95); z-index: 2147483647;
            display: flex; justify-content: center; align-items: center;
            touch-action: manipulation; 
        }
        .start-btn {
            font-size: 1.8rem; font-weight: 900; color: #FFD700;
            border: 4px solid #FFD700; padding: 30px 60px;
            border-radius: 80px; background: rgba(255, 215, 0, 0.1);
            box-shadow: 0 0 50px rgba(255, 215, 0, 0.5);
            animation: pulse 1.5s infinite; pointer-events: none;
        }
        @keyframes pulse {
            0%, 100% { transform: scale(1); }
            50% { transform: scale(1.05); box-shadow: 0 0 80px rgba(255,215,0,0.8); }
        }

        /* --- 3. åŸºç¡€å…ƒç´  --- */
        canvas { position: absolute; top: 0; left: 0; z-index: 1; }
        .music-btn {
            position: fixed; top: 20px; right: 20px; z-index: 100;
            width: 40px; height: 40px; background: rgba(255, 255, 255, 0.2);
            border: 2px solid #FFD700; border-radius: 50%;
            display: flex; justify-content: center; align-items: center;
            animation: rotate 4s linear infinite; opacity: 0; transition: opacity 1s;
        }
        .music-btn.paused { animation-play-state: paused; opacity: 0.5; }
        @keyframes rotate { to { transform: rotate(360deg); } }

        /* --- 4. ä¸­é—´æ–‡å­—å±‚ (é«˜çº§é‡‘å…‰ç‰¹æ•ˆ) --- */
        .center-text {
            position: absolute; top: 40%; left: 50%;
            transform: translate(-50%, -50%);
            z-index: 10; text-align: center; width: 100%;
            pointer-events: none;
            /* æ•´ä½“å®¹å™¨æµ®ç°åŠ¨ç”» */
            opacity: 0;
            animation: fadeInUpContainer 1.5s ease-out forwards;
        }
        @keyframes fadeInUpContainer {
            from { opacity: 0; transform: translate(-50%, -40%); filter: blur(10px); }
            to { opacity: 1; transform: translate(-50%, -50%); filter: blur(0); }
        }

        /* å¤§æ ‡é¢˜ "2026" - é‡‘è‰²æµå…‰ç‰¹æ•ˆ */
        .year {
            font-family: 'Cinzel', serif; font-size: 5rem;
            font-weight: 900; line-height: 1; margin-bottom: 20px;
            /* æµå…‰æ¸å˜èƒŒæ™¯ */
            background: linear-gradient(120deg, #FFD700 0%, #fff 30%, #FFD700 60%, #d4af37 100%);
            background-size: 200% auto; 
            -webkit-background-clip: text; -webkit-text-fill-color: transparent;
            text-shadow: 0 0 30px rgba(255, 215, 0, 0.6);
            /* å¤åˆåŠ¨ç”»ï¼šæµå…‰æ‰«è¿‡ + æ”¾å¤§å‡ºç° */
            animation: shine 4s linear infinite, textAppear 1.2s cubic-bezier(0.2, 0.8, 0.2, 1) forwards 0.3s;
            opacity: 0; transform: scale(0.8);
        }
        @keyframes shine { to { background-position: 200% center; } }
        @keyframes textAppear { to { opacity: 1; transform: scale(1); text-shadow: 0 0 40px rgba(255, 215, 0, 0.8); } }

        /* è½®æ’­è¯—å¥ - æ¨¡ç³Šæ·¡å…¥æ·¡å‡º */
        #rotating-text {
            font-size: 1.2rem; color: #dcdcdc; letter-spacing: 4px;
            margin-bottom: 30px; font-weight: 300; min-height: 30px;
            opacity: 1; transition: opacity 0.8s ease, filter 0.8s ease, transform 0.8s ease;
        }
        /* éšè—çŠ¶æ€çš„æ ·å¼ (é…åˆJSåˆ‡æ¢) */
        #rotating-text.hidden { opacity: 0; filter: blur(8px); transform: translateY(10px); }

        /* äº’åŠ¨æ–‡å­—åŒº - å¼¹æ€§å¼¹å‡º */
        #message-board {
            display: flex; flex-direction: column;
            align-items: center; justify-content: flex-start;
            min-height: 220px;
        }
        .msg-line {
            opacity: 0; 
            animation: magicPop 0.8s cubic-bezier(0.34, 1.56, 0.64, 1) forwards;
            text-shadow: 0 0 10px rgba(0,0,0,0.8);
        }
        @keyframes magicPop {
            0% { opacity: 0; transform: translateY(40px) scale(0.5); filter: blur(15px); }
            60% { opacity: 1; transform: translateY(-10px) scale(1.05); filter: blur(0); }
            100% { opacity: 1; transform: translateY(0) scale(1); }
        }

        .msg-name {
            font-size: 3.2rem; font-weight: 900; color: #fff;
            text-shadow: 0 0 20px #FFD700, 0 0 40px #FFD700; /* åŒé‡å‘å…‰ */
            margin-bottom: 15px; border-bottom: 2px solid rgba(255, 215, 0, 0.6);
            padding-bottom: 8px; display: inline-block;
            transform-origin: center bottom;
        }
        .msg-blessing {
            font-size: 1.8rem; color: #ffecd2;
            letter-spacing: 4px; margin-top: 10px; font-weight: 700;
        }

        /* --- 5. åº•éƒ¨æç¤º & å¼¹å¹• --- */
        #inner-tip-box {
            position: fixed; bottom: 8%; left: 50%; transform: translateX(-50%);
            z-index: 20; color: #FFD700; border: 1px solid #FFD700;
            padding: 8px 25px; border-radius: 30px;
            font-size: 0.9rem; background: rgba(0,0,0,0.6);
            opacity: 0; pointer-events: none; transition: opacity 1s;
        }
        .tip-anim { animation: flash 1.5s infinite alternate; }
        @keyframes flash { from { opacity: 0.6; transform: translateX(-50%) scale(1); } to { opacity: 1; transform: translateX(-50%) scale(1.05); } }

        #danmaku-container {
            position: absolute; top: 0; left: 0; width: 100%; height: 100%;
            z-index: 5; pointer-events: none; overflow: hidden;
        }
        .danmaku-item {
            position: absolute; white-space: nowrap; color: rgba(255,255,255,0.9);
            font-size: 1.2rem; text-shadow: 0 0 3px black; font-weight: bold;
            animation: move 10s linear forwards;
        }
        @keyframes move { from { transform: translateX(100vw); } to { transform: translateX(-100%); } }

        /* --- 6. åª’ä½“æŸ¥è¯¢ --- */
        @media screen and (max-width: 480px) {
            .year { font-size: 4rem; margin-bottom: 10px; }
            #rotating-text { font-size: 1rem; letter-spacing: 2px; margin-bottom: 20px; }
            .msg-name { font-size: 2.5rem; }
            .msg-blessing { font-size: 1.4rem; }
        }
    </style>
</head>
<body>

    <audio id="bgm" loop preload="auto">
        <source src="é¹¿æ™— - æˆ‘ä»¬çš„æ˜å¤© (Live in Beijing).mp3" type="audio/mpeg">
    </audio>

    <div id="start-overlay" onclick="startApp()">
        <div class="start-btn">ğŸ‘‡ ç‚¹å‡»å¼€å¯<br>2026 æ–°å¹´</div>
    </div>

    <div class="music-btn" id="musicBtn"><div style="font-size: 20px;">ğŸµ</div></div>

    <canvas id="canvas"></canvas>
    <div id="danmaku-container"></div>

    <div class="center-text">
        <div class="year">2026</div>
        <div id="rotating-text">æ–°å²åºå¼€ Â· å…±èµ´å±±æµ·</div>
        <div id="message-board"></div>
    </div>

    <div id="inner-tip-box" class="tip-anim">ğŸ‘† ç‚¹å‡»å±å¹• Â· æ­æ™“ç¥ç¦ ğŸ‘†</div>

    <script>
        // --- 1. é…ç½®æ•°æ® ---
        const params = new URLSearchParams(window.location.search);
        let nameText = params.get('name') || "æå€©"; 

        const poeticMessages = [
            "æ–°å²åºå¼€ Â· å…±èµ´å±±æµ·", "å²å²å¸¸æ¬¢æ„‰ Â· å¹´å¹´çš†èƒœæ„", "çƒŸç«å‘æ˜Ÿè¾° Â· æ‰€æ„¿çš†æˆçœŸ",
            "ä¸‡ç‰©æ›´æ–° Â· æ—§ç–¾å½“æ„ˆ", "ä¿æŒçƒ­çˆ± Â· å¥”èµ´å±±æµ·", "å‰è·¯æµ©æµ©è¡è¡ Â· ä¸‡äº‹å°½å¯æœŸå¾…",
            "å¤šå–œä¹ Â· é•¿å®‰å®"
        ];

        const danmakuTemplates = [
            "ç¥ {n} 2026 è´¢æºå¹¿è¿›", "æ„¿ {n} å¤©å¤©å¼€å¿ƒ", "{n} æ–°å¹´å¿«ä¹ ä¸‡äº‹èƒœæ„",
            "ç¥ {n} é¢œå€¼çˆ†è¡¨", "æ„¿ {n} å²å²å¹³å®‰", "{n} 2026 æš´å¯Œæš´ç˜¦",
            "ç¥ {n} å¥½è¿è¿è¿", "æ„¿ {n} å¿ƒæƒ³äº‹æˆ", "{n} å¿…å®š å‡èŒåŠ è–ª",
            "ç¥ {n} æ°¸è¿œå°‘å¹´", "æ„¿ {n} æ‰€æ±‚çš†å¦‚æ„¿", "ç¥ {n} å‰ç¨‹ä¼¼é”¦"
        ];

        const contentSequence = [
            { text: "ç¥ " + nameText, type: 'name' },    
            { text: "æ–°å¹´å¿«ä¹", type: 'blessing' },      
            { text: "é©¬å¹´å¤§å‰", type: 'blessing' },      
            { text: "å¿ƒæƒ³äº‹æˆ", type: 'blessing' }       
        ];

        let clickCount = 0;
        let started = false;

        // --- 2. å¯åŠ¨é€»è¾‘ ---
        const overlay = document.getElementById('start-overlay');
        const bgm = document.getElementById('bgm');
        const musicBtn = document.getElementById('musicBtn');
        const innerTip = document.getElementById('inner-tip-box');
        const msgBoard = document.getElementById('message-board');
        const rotatingTextEl = document.getElementById('rotating-text');

        function startApp() {
            if (started) return;
            started = true;
            overlay.style.display = 'none';
            musicBtn.style.opacity = '1';
            innerTip.style.opacity = '1';
            
            bgm.play().catch(e => { musicBtn.classList.add('paused'); });
            
            // å¯åŠ¨æ—¶æ”¾å‡ ä¸ªçƒŸèŠ±
            createFirework(window.innerWidth/2, window.innerHeight*0.3);
            setTimeout(()=>createFirework(window.innerWidth*0.3, window.innerHeight*0.4), 400);
            
            startRotation();
        }
        overlay.addEventListener('touchstart', (e) => { e.preventDefault(); startApp(); }, {passive: false});

        // --- 3. è¯—å¥è½®æ’­ (é…åˆæ–°ç‰¹æ•ˆ) ---
        let rotIndex = 0;
        rotatingTextEl.classList.add('hidden'); // åˆå§‹éšè—
        setTimeout(() => rotatingTextEl.classList.remove('hidden'), 1500); // éšåæµ®ç°

        function startRotation() {
            setInterval(() => {
                rotatingTextEl.classList.add('hidden'); // æ·¡å‡º
                setTimeout(() => {
                    rotIndex = (rotIndex + 1) % poeticMessages.length;
                    rotatingTextEl.innerText = poeticMessages[rotIndex];
                    rotatingTextEl.classList.remove('hidden'); // æ·¡å…¥
                }, 800); 
            }, 4000); 
        }

        // --- 4. å¼¹å¹•ç³»ç»Ÿ ---
        const danmakuContainer = document.getElementById('danmaku-container');

        function sendDanmaku(text=null, y=null) {
            const div = document.createElement('div');
            div.className = 'danmaku-item';
            let content = text;
            if(!content) {
                content = danmakuTemplates[Math.floor(Math.random() * danmakuTemplates.length)];
            }
            div.innerText = content.replace(/{n}/g, nameText);

            if(y) {
                div.style.color = '#FFD700'; div.style.textShadow = '0 0 15px #FFD700';
                div.style.zIndex = 100; div.style.top = (y - 30) + 'px'; div.style.fontSize = '1.4rem';
            } else {
                div.style.top = Math.random()*85 + 5 + '%'; div.style.opacity = 0.7;
            }
            danmakuContainer.appendChild(div);
            setTimeout(() => div.remove(), 10000);
        }
        setInterval(() => sendDanmaku(), 1500);

        // --- 5. ç‚¹å‡»äº¤äº’ (é…åˆæ–°ç‰¹æ•ˆ) ---
        window.addEventListener('pointerdown', (e) => {
            if(!started) return;
            createFirework(e.clientX, e.clientY);

            if(clickCount < contentSequence.length) {
                const item = contentSequence[clickCount];
                const div = document.createElement('div');
                div.innerText = item.text;
                if(item.type === 'name') div.className = 'msg-line msg-name';
                else div.className = 'msg-line msg-blessing';
                msgBoard.appendChild(div);
                clickCount++;

                if(clickCount === contentSequence.length) {
                    innerTip.innerText = "âœ¨ 2026 ä¸‡äº‹èƒœæ„ âœ¨";
                    innerTip.classList.remove('tip-anim');
                    setTimeout(() => {
                        for(let i=0; i<5; i++) createFirework(Math.random()*window.innerWidth, window.innerHeight*0.4);
                    }, 300);
                }
            } else {
                const randomMsg = danmakuTemplates[Math.floor(Math.random() * danmakuTemplates.length)];
                sendDanmaku(randomMsg, e.clientY);
            }
        });

        // --- 6. æ ¸å¿ƒï¼šå¸¦å½¢çŠ¶çš„çƒŸèŠ±ç‰©ç†å¼•æ“ ---
        const canvas = document.getElementById('canvas');
        const ctx = canvas.getContext('2d');
        let w, h;
        function resize() { w=canvas.width=window.innerWidth; h=canvas.height=window.innerHeight; }
        window.addEventListener('resize', resize);
        resize();
        
        let particles = [];
        const r = (min, max) => Math.random() * (max - min) + min;

        class P {
            constructor(x, y, color) {
                this.x=x; this.y=y; this.color=color;
                this.vx=0; this.vy=0;
                this.alpha = 1; this.decay = r(0.015, 0.03);
            }
            update() { this.x+=this.vx; this.y+=this.vy; this.vy+=0.05; this.vx*=0.96; this.vy*=0.96; this.alpha-=this.decay; }
            draw() {
                ctx.globalAlpha = this.alpha; ctx.fillStyle = this.color;
                ctx.beginPath(); ctx.arc(this.x, this.y, 2, 0, Math.PI*2); ctx.fill();
            }
        }

        function createFirework(x, y) {
            const count = 100;
            const hue = Math.random()*360;
            const type = Math.random() > 0.7 ? 'heart' : 'circle'; 
            
            for(let i=0; i<count; i++) {
                const p = new P(x, y, `hsl(${hue}, 100%, 60%)`);
                const angle = (Math.PI*2*i)/count;
                
                if(type === 'heart') {
                    const xx = 16 * Math.pow(Math.sin(angle), 3);
                    const yy = -(13*Math.cos(angle) - 5*Math.cos(2*angle) - 2*Math.cos(3*angle) - Math.cos(4*angle));
                    p.vx = xx * 0.15; 
                    p.vy = yy * 0.15;
                } else {
                    const speed = r(2, 8);
                    p.vx = Math.cos(angle) * speed;
                    p.vy = Math.sin(angle) * speed;
                }
                particles.push(p);
            }
        }

        function loop() {
            ctx.globalCompositeOperation = 'source-over';
            ctx.fillStyle = 'rgba(0,0,0,0.15)'; ctx.fillRect(0,0,w,h);
            ctx.globalCompositeOperation = 'lighter';
            
            for(let i=particles.length-1; i>=0; i--) {
                particles[i].update(); particles[i].draw();
                if(particles[i].alpha<=0) particles.splice(i,1);
            }
            
            if(started && Math.random() < 0.04) {
                createFirework(Math.random()*w, r(h*0.1, h*0.5));
            }
            requestAnimationFrame(loop);
        }
        loop();

        musicBtn.addEventListener('click', (e) => {
            e.stopPropagation();
            if(bgm.paused) { bgm.play(); musicBtn.classList.remove('paused'); }
            else { bgm.pause(); musicBtn.classList.add('paused'); }
        });
    </script>
</body>
</html>
